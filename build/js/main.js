"use strict";

//fade-in when visible
document.addEventListener("DOMContentLoaded", function () {
  var elements = document.querySelectorAll(".fade-in, .slideInLeft, .slideInRight, .fadeInFromTop");
  function checkVisibility() {
    elements.forEach(function (el) {
      var rect = el.getBoundingClientRect();
      if (rect.top < window.innerHeight * 0.9) {
        el.classList.add("visible");
      }
    });
  }
  window.addEventListener("scroll", checkVisibility);
  checkVisibility();
});

//open form block
document.addEventListener("DOMContentLoaded", function () {
  var btn = document.querySelector(".header__content-btn");
  var form = document.querySelector(".firstForm");
  btn.addEventListener("click", function () {
    if (form.style.display === "none" || form.style.display === "") {
      form.style.display = "block";
      btn.textContent = "Згорнути";
    } else {
      form.style.display = "none";
      btn.textContent = "Доєднатись";
    }
  });
});

//slider
document.addEventListener("DOMContentLoaded", function () {
  var sliderWrapper = document.querySelector(".slider__wrapper");
  var slides = document.querySelectorAll(".slider__slide");
  var prevBtn = document.querySelector(".slider__btn-prev");
  var nextBtn = document.querySelector(".slider__btn-next");
  var dotsContainer = document.querySelector(".slider__dots");
  var currentIndex = 0;
  var interval;
  var touchStartX = 0;
  var touchEndX = 0;
  function updateSlider() {
    slides.forEach(function (slide, index) {
      slide.classList.remove("active", "opacity");
      slide.classList.add("".concat(index === currentIndex ? "active" : "opacity"));
    });
    document.querySelectorAll(".slider__dot").forEach(function (dot, index) {
      dot.classList.toggle("active", index === currentIndex);
    });
    stopAutoSlide();
    startAutoSlide();
  }
  function nextSlide() {
    currentIndex = (currentIndex + 1) % slides.length;
    updateSlider();
  }
  function prevSlide() {
    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
    updateSlider();
  }
  function startAutoSlide() {
    interval = setInterval(nextSlide, 3000);
  }
  function stopAutoSlide() {
    clearInterval(interval);
  }
  function handleTouchStart(event) {
    touchStartX = event.touches[0].clientX;
  }
  function handleTouchEnd(event) {
    touchEndX = event.changedTouches[0].clientX;
    handleSwipe();
  }
  function handleSwipe() {
    var swipeThreshold = 50;
    if (touchStartX - touchEndX > swipeThreshold) {
      nextSlide();
    } else if (touchEndX - touchStartX > swipeThreshold) {
      prevSlide();
    }
  }
  slides.forEach(function (_, index) {
    var dot = document.createElement("span");
    dot.classList.add("slider__dot");
    dot.addEventListener("click", function () {
      currentIndex = index;
      updateSlider();
    });
    dotsContainer.appendChild(dot);
  });
  prevBtn.addEventListener("click", prevSlide);
  nextBtn.addEventListener("click", nextSlide);

  // mob swipe
  sliderWrapper.addEventListener("touchstart", handleTouchStart);
  sliderWrapper.addEventListener("touchend", handleTouchEnd);
  updateSlider();
});

//form
document.addEventListener("DOMContentLoaded", function () {
  var forms = document.querySelectorAll('form'); // Все формы на странице

  forms.forEach(function (form) {
    var phoneInput = form.querySelector('.form__input-phone');
    var dateInput = form.querySelector('.form__input-date');
    var regionInput = form.querySelector('.form__input-region');
    var checkboxInput = form.querySelector('.form__input-checkbox');
    var radioInputs = form.querySelectorAll('input[name="yes-no"]'); // Для проверки военнослужащего
    var submitButton = form.querySelector('.form__submit');
    var allInputs = form.querySelectorAll('.form__input');
    var telegramInput = form.querySelector('.form__input-telegram'); // Нік в телеграмі
    var formWarning = form.querySelector('.form__warning'); // Контейнер для предупреждений

    // telephone
    phoneInput.addEventListener('focus', function () {
      if (phoneInput.value.trim() === '') {
        phoneInput.value = '+38'; // Автозаполнение при фокусе
        phoneInput.setSelectionRange(3, 3); // Ставим курсор после +38
      }
    });
    phoneInput.addEventListener('input', function (e) {
      var start = this.selectionStart;
      var rawValue = this.value.replace(/\D/g, ''); // Убираем все нецифровые символы

      if (e.inputType === "deleteContentBackward" && this.value.endsWith(" ")) {
        this.value = this.value.slice(0, -1);
        start--; // Корректируем позицию каретки при удалении пробела
      }
      var formattedValue = '+38';
      if (rawValue.length > 2) formattedValue += ' ' + rawValue.slice(2, 5);
      if (rawValue.length > 5) formattedValue += ' ' + rawValue.slice(5, 8);
      if (rawValue.length > 8) formattedValue += ' ' + rawValue.slice(8, 10);
      if (rawValue.length > 10) formattedValue += ' ' + rawValue.slice(10, 12);

      // Определяем разницу в длине
      var diff = formattedValue.length - this.value.length;
      this.value = formattedValue;

      // Корректируем позицию каретки
      this.setSelectionRange(start + diff, start + diff);
    });

    //calendar
    dateInput.addEventListener('input', function () {
      var parts = this.value.split('-');
      if (parts[0] && parts[0].length > 4) {
        parts[0] = parts[0].slice(0, 4);
        this.value = parts.join('-');
      }
    });

    //input
    form.addEventListener('input', function (event) {
      var targetInput = event.target;
      if (targetInput.classList.contains('warning')) {
        validateSingleInput(targetInput);
      }
      var isAnyInputFilled = Array.from(allInputs).some(function (input) {
        return input.value.trim() !== "" || input.checked;
      });
      if (isAnyInputFilled) {
        submitButton.classList.add('active');
      } else {
        submitButton.classList.remove('active');
      }
    });

    // check 1 input
    function validateSingleInput(input) {
      if (input.type === "date" && input.value === "2000-01-01") {
        input.classList.add('warning');
      } else if (input.value.trim() === "" || input.classList.contains('form__input-phone') && !/^\+38\s*\d{3}\s*\d{3}\s*\d{2}\s*\d{2}$/.test(input.value)) {
        input.classList.add('warning');
      } else if (input.classList.contains('form__input-region') && input.value === "") {
        input.classList.add('warning');
      } else if (input.classList.contains('form__input-checkbox') && !input.checked) {
        input.classList.add('warning');
      } else if (input.classList.contains('form__input-radio')) {
        var isRadioChecked = Array.from(radioInputs).some(function (radio) {
          return radio.checked;
        });
        if (!isRadioChecked) {
          radioInputs.forEach(function (radio) {
            return radio.classList.add('warning');
          });
        } else {
          radioInputs.forEach(function (radio) {
            return radio.classList.remove('warning');
          });
        }
      } else {
        input.classList.remove('warning');
      }
    }

    // validation

    function checkValid() {
      var isValid = false;
      var warnings = form.querySelectorAll(".warning");
      warnings.forEach(function (warning) {
        return warning.classList.remove("warning");
      }); // Очистити попередні помилки

      var addWarning = function addWarning(input, message) {
        isValid = false;
        input.classList.add("warning");
        var warningMessage = input.nextElementSibling;
        if (!warningMessage || !warningMessage.classList.contains("form__warning")) {
          warningMessage = document.createElement("p");
          warningMessage.classList.add("form__warning");
          warningMessage.textContent = message;
          input.parentNode.appendChild(warningMessage);
        }
      };
      var surnameValid = false;
      var firstNameValid = false;
      var secondNameValid = false;
      var phoneValid = false;
      var birthDateValid = false;
      var isMilitaryValid = false;
      var consentValid = false;
      var surname = form.querySelector(".form__input-surname");
      surname.addEventListener("input", function () {
        if (!surname.value.trim()) addWarning(surname, "Прізвище обов'язкове");
      });
      if (!surname.value.trim()) {
        addWarning(surname, "Прізвище обов'язкове");
      } else {
        surnameValid = true;
      }
      var firstName = form.querySelector(".form__input-first-name");
      if (!firstName.value.trim()) {
        addWarning(firstName, "Ім'я обов'язкове");
      } else {
        firstNameValid = true;
      }
      var secondName = form.querySelector(".form__input-middle-name");
      if (!secondName.value.trim()) {
        addWarning(secondName, "По батькові обов'язкове");
      } else {
        secondNameValid = true;
      }
      var phone = form.querySelector(".form__input-phone");
      if (!phone.value.trim() || !/^\+38\s?\d{3}\s?\d{3}\s?\d{2}\s?\d{2}$/.test(phone.value)) {
        addWarning(phone, "Номер телефону обов'язковий");
      } else {
        phoneValid = true;
      }
      var birthDate = form.querySelector(".form__input-date");
      if (!birthDate.value || birthDate.value === "2000-01-01") {
        addWarning(birthDate, "Дата народження обов'язкова");
      } else {
        birthDateValid = true;
      }
      var isMilitary = form.querySelector(".form__input-radio:checked");
      if (!isMilitary) {
        addWarning(form.querySelector(".form__radio-group"), "Оберіть варіант");
      } else {
        isMilitaryValid = true;
      }
      var consent = form.querySelector(".form__input-checkbox");
      if (!consent.checked) {
        addWarning(consent, "Ви повинні погодитися з обробкою даних");
      } else {
        consentValid = true;
      }
      if (surnameValid && firstNameValid && secondNameValid && phoneValid && birthDateValid && isMilitaryValid && consentValid) {
        isValid = true;
      }
      if (!isValid) {
        formWarning.classList.add('visible');
        submitButton.classList.add('warning');
      } else {
        formWarning.classList.remove('visible');
        submitButton.classList.remove('warning');
      }
      return isValid;
    }
    forms.forEach(function (form) {
      form.addEventListener("submit", function (event) {
        event.preventDefault(); // Заблокувати стандартну відправку

        var isValid = checkValid();
        console.log(isValid);

        // Перевірка каптчі
        var recaptchaResponse = grecaptcha.getResponse(); // Отримуємо відповідь з каптчі
        if (recaptchaResponse.length === 0) {
          // Перевірка каптчі лише один раз
          if (!document.querySelector('.recaptcha').classList.contains('checked')) {
            alert("Будь ласка, пройдіть перевірку reCAPTCHA.");
            document.querySelector('.page').classList.add('hidden'); // Сховати контент
            document.querySelector('.recaptcha').style.display = 'flex'; // Показати каптчу
            document.querySelector('.recaptcha').classList.add('checked'); // Додати клас, щоб не повторювати перевірку
          }
          return; // Якщо каптча не пройдена, не відправляємо форму
        }
        if (isValid) {
          var formData = new FormData(form);
          var successMessage = form.querySelector('.form__success');
          if (successMessage) {
            successMessage.classList.add('visible');
            setTimeout(function () {
              successMessage.classList.remove('visible');
              formWarning.classList.add('visible');
              form.reset();
            }, 5000);
            successMessage.addEventListener('click', function () {
              successMessage.classList.remove('visible');
              formWarning.classList.add('visible');
              form.reset();
            });
          }
          fetch(form.action, {
            method: "POST",
            body: formData
          }).then(function (response) {
            return response.text();
          }).then(function (data) {
            console.log(data); // Вивести відповідь від сервера

            var successMessage = form.querySelector('.form__success');
            var errorMessage = form.querySelector('.form__warning');
            if (data.includes("Дякуємо за вашу заявку!")) {
              // Показати повідомлення про успіх
              if (successMessage) {
                successMessage.classList.add('visible');
                setTimeout(function () {
                  successMessage.classList.remove('visible');
                  form.reset(); // Очистити форму
                }, 5000);
              }
            } else {
              // Показати повідомлення про помилку
            }
          })["catch"](function (error) {
            console.error("Помилка при відправці форми:", error);
            var errorMessage = form.querySelector('.form__warning');
            if (errorMessage) {
              errorMessage.textContent = "Помилка при відправці форми. Спробуйте ще раз.";
              errorMessage.classList.add('visible');
            }
          });
        }
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2hlY2tWaXNpYmlsaXR5IiwiZm9yRWFjaCIsImVsIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsIndpbmRvdyIsImlubmVySGVpZ2h0IiwiY2xhc3NMaXN0IiwiYWRkIiwiYnRuIiwicXVlcnlTZWxlY3RvciIsImZvcm0iLCJzdHlsZSIsImRpc3BsYXkiLCJ0ZXh0Q29udGVudCIsInNsaWRlcldyYXBwZXIiLCJzbGlkZXMiLCJwcmV2QnRuIiwibmV4dEJ0biIsImRvdHNDb250YWluZXIiLCJjdXJyZW50SW5kZXgiLCJpbnRlcnZhbCIsInRvdWNoU3RhcnRYIiwidG91Y2hFbmRYIiwidXBkYXRlU2xpZGVyIiwic2xpZGUiLCJpbmRleCIsInJlbW92ZSIsImNvbmNhdCIsImRvdCIsInRvZ2dsZSIsInN0b3BBdXRvU2xpZGUiLCJzdGFydEF1dG9TbGlkZSIsIm5leHRTbGlkZSIsImxlbmd0aCIsInByZXZTbGlkZSIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImhhbmRsZVRvdWNoU3RhcnQiLCJldmVudCIsInRvdWNoZXMiLCJjbGllbnRYIiwiaGFuZGxlVG91Y2hFbmQiLCJjaGFuZ2VkVG91Y2hlcyIsImhhbmRsZVN3aXBlIiwic3dpcGVUaHJlc2hvbGQiLCJfIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiZm9ybXMiLCJwaG9uZUlucHV0IiwiZGF0ZUlucHV0IiwicmVnaW9uSW5wdXQiLCJjaGVja2JveElucHV0IiwicmFkaW9JbnB1dHMiLCJzdWJtaXRCdXR0b24iLCJhbGxJbnB1dHMiLCJ0ZWxlZ3JhbUlucHV0IiwiZm9ybVdhcm5pbmciLCJ2YWx1ZSIsInRyaW0iLCJzZXRTZWxlY3Rpb25SYW5nZSIsImUiLCJzdGFydCIsInNlbGVjdGlvblN0YXJ0IiwicmF3VmFsdWUiLCJyZXBsYWNlIiwiaW5wdXRUeXBlIiwiZW5kc1dpdGgiLCJzbGljZSIsImZvcm1hdHRlZFZhbHVlIiwiZGlmZiIsInBhcnRzIiwic3BsaXQiLCJqb2luIiwidGFyZ2V0SW5wdXQiLCJ0YXJnZXQiLCJjb250YWlucyIsInZhbGlkYXRlU2luZ2xlSW5wdXQiLCJpc0FueUlucHV0RmlsbGVkIiwiQXJyYXkiLCJmcm9tIiwic29tZSIsImlucHV0IiwiY2hlY2tlZCIsInR5cGUiLCJ0ZXN0IiwiaXNSYWRpb0NoZWNrZWQiLCJyYWRpbyIsImNoZWNrVmFsaWQiLCJpc1ZhbGlkIiwid2FybmluZ3MiLCJ3YXJuaW5nIiwiYWRkV2FybmluZyIsIm1lc3NhZ2UiLCJ3YXJuaW5nTWVzc2FnZSIsIm5leHRFbGVtZW50U2libGluZyIsInBhcmVudE5vZGUiLCJzdXJuYW1lVmFsaWQiLCJmaXJzdE5hbWVWYWxpZCIsInNlY29uZE5hbWVWYWxpZCIsInBob25lVmFsaWQiLCJiaXJ0aERhdGVWYWxpZCIsImlzTWlsaXRhcnlWYWxpZCIsImNvbnNlbnRWYWxpZCIsInN1cm5hbWUiLCJmaXJzdE5hbWUiLCJzZWNvbmROYW1lIiwicGhvbmUiLCJiaXJ0aERhdGUiLCJpc01pbGl0YXJ5IiwiY29uc2VudCIsInByZXZlbnREZWZhdWx0IiwiY29uc29sZSIsImxvZyIsInJlY2FwdGNoYVJlc3BvbnNlIiwiZ3JlY2FwdGNoYSIsImdldFJlc3BvbnNlIiwiYWxlcnQiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwic3VjY2Vzc01lc3NhZ2UiLCJzZXRUaW1lb3V0IiwicmVzZXQiLCJmZXRjaCIsImFjdGlvbiIsIm1ldGhvZCIsImJvZHkiLCJ0aGVuIiwicmVzcG9uc2UiLCJ0ZXh0IiwiZGF0YSIsImVycm9yTWVzc2FnZSIsImluY2x1ZGVzIiwiZXJyb3IiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQUEsUUFBUSxDQUFDQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsRUFBRSxZQUFZO0VBQ3RELElBQU1DLFFBQVEsR0FBR0YsUUFBUSxDQUFD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LENBQUMsQ0FBQztJQUNOLENBQUMsQ0FBQztFQUlOLENBQUMsQ0FBQztBQUNOLENBQUMsQ0FBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9mYWRlLWluIHdoZW4gdmlzaWJsZVxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mYWRlLWluLCAuc2xpZGVJbkxlZnQsIC5zbGlkZUluUmlnaHQsIC5mYWRlSW5Gcm9tVG9wXCIpO1xuXG4gICAgZnVuY3Rpb24gY2hlY2tWaXNpYmlsaXR5KCkge1xuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGlmIChyZWN0LnRvcCA8IHdpbmRvdy5pbm5lckhlaWdodCAqIDAuOSkge1xuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoXCJ2aXNpYmxlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBjaGVja1Zpc2liaWxpdHkpO1xuICAgIGNoZWNrVmlzaWJpbGl0eSgpO1xufSk7XG5cbi8vb3BlbiBmb3JtIGJsb2NrXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2NvbnRlbnQtYnRuXCIpO1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZpcnN0Rm9ybVwiKTtcblxuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoZm9ybS5zdHlsZS5kaXNwbGF5ID09PSBcIm5vbmVcIiB8fCBmb3JtLnN0eWxlLmRpc3BsYXkgPT09IFwiXCIpIHtcbiAgICAgICAgICAgIGZvcm0uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgICAgIGJ0bi50ZXh0Q29udGVudCA9IFwi0JfQs9C+0YDQvdGD0YLQuFwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9ybS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgICBidG4udGV4dENvbnRlbnQgPSBcItCU0L7RlNC00L3QsNGC0LjRgdGMXCI7XG4gICAgICAgIH1cbiAgICB9KTtcbn0pO1xuXG4vL3NsaWRlclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHNsaWRlcldyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fd3JhcHBlclwiKTtcbiAgICBjb25zdCBzbGlkZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNsaWRlcl9fc2xpZGVcIik7XG4gICAgY29uc3QgcHJldkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19idG4tcHJldlwiKTtcbiAgICBjb25zdCBuZXh0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX2J0bi1uZXh0XCIpO1xuICAgIGNvbnN0IGRvdHNDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNsaWRlcl9fZG90c1wiKTtcbiAgICBsZXQgY3VycmVudEluZGV4ID0gMDtcbiAgICBsZXQgaW50ZXJ2YWw7XG4gICAgbGV0IHRvdWNoU3RhcnRYID0gMDtcbiAgICBsZXQgdG91Y2hFbmRYID0gMDtcblxuICAgIGZ1bmN0aW9uIHVwZGF0ZVNsaWRlcigpIHtcbiAgICAgICAgc2xpZGVzLmZvckVhY2goKHNsaWRlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgc2xpZGUuY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiLCBcIm9wYWNpdHlcIilcbiAgICAgICAgICAgIHNsaWRlLmNsYXNzTGlzdC5hZGQoYCR7aW5kZXggPT09IGN1cnJlbnRJbmRleCA/IFwiYWN0aXZlXCIgOiBcIm9wYWNpdHlcIn1gKVxuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zbGlkZXJfX2RvdFwiKS5mb3JFYWNoKChkb3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICBkb3QuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2ZVwiLCBpbmRleCA9PT0gY3VycmVudEluZGV4KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc3RvcEF1dG9TbGlkZSgpO1xuICAgICAgICBzdGFydEF1dG9TbGlkZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5leHRTbGlkZSgpIHtcbiAgICAgICAgY3VycmVudEluZGV4ID0gKGN1cnJlbnRJbmRleCArIDEpICUgc2xpZGVzLmxlbmd0aDtcbiAgICAgICAgdXBkYXRlU2xpZGVyKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHJldlNsaWRlKCkge1xuICAgICAgICBjdXJyZW50SW5kZXggPSAoY3VycmVudEluZGV4IC0gMSArIHNsaWRlcy5sZW5ndGgpICUgc2xpZGVzLmxlbmd0aDtcbiAgICAgICAgdXBkYXRlU2xpZGVyKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RhcnRBdXRvU2xpZGUoKSB7XG4gICAgICAgIGludGVydmFsID0gc2V0SW50ZXJ2YWwobmV4dFNsaWRlLCAzMDAwKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdG9wQXV0b1NsaWRlKCkge1xuICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVUb3VjaFN0YXJ0KGV2ZW50KSB7XG4gICAgICAgIHRvdWNoU3RhcnRYID0gZXZlbnQudG91Y2hlc1swXS5jbGllbnRYO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhhbmRsZVRvdWNoRW5kKGV2ZW50KSB7XG4gICAgICAgIHRvdWNoRW5kWCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICAgIGhhbmRsZVN3aXBlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlU3dpcGUoKSB7XG4gICAgICAgIGNvbnN0IHN3aXBlVGhyZXNob2xkID0gNTA7XG4gICAgICAgIGlmICh0b3VjaFN0YXJ0WCAtIHRvdWNoRW5kWCA+IHN3aXBlVGhyZXNob2xkKSB7XG4gICAgICAgICAgICBuZXh0U2xpZGUoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0b3VjaEVuZFggLSB0b3VjaFN0YXJ0WCA+IHN3aXBlVGhyZXNob2xkKSB7XG4gICAgICAgICAgICBwcmV2U2xpZGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNsaWRlcy5mb3JFYWNoKChfLCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBkb3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICAgICAgZG90LmNsYXNzTGlzdC5hZGQoXCJzbGlkZXJfX2RvdFwiKTtcbiAgICAgICAgZG90LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBjdXJyZW50SW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgIHVwZGF0ZVNsaWRlcigpO1xuICAgICAgICB9KTtcbiAgICAgICAgZG90c0NvbnRhaW5lci5hcHBlbmRDaGlsZChkb3QpO1xuICAgIH0pO1xuXG4gICAgcHJldkJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgcHJldlNsaWRlKTtcbiAgICBuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBuZXh0U2xpZGUpO1xuXG4gICAgLy8gbW9iIHN3aXBlXG4gICAgc2xpZGVyV3JhcHBlci5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBoYW5kbGVUb3VjaFN0YXJ0KTtcbiAgICBzbGlkZXJXcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGVuZFwiLCBoYW5kbGVUb3VjaEVuZCk7XG5cbiAgICB1cGRhdGVTbGlkZXIoKTtcbn0pO1xuXG5cbi8vZm9ybVxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xuICAgIGNvbnN0IGZvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZm9ybScpOyAgLy8g0JLRgdC1INGE0L7RgNC80Ysg0L3QsCDRgdGC0YDQsNC90LjRhtC1XG5cbiAgICBmb3Jtcy5mb3JFYWNoKGZvcm0gPT4ge1xuICAgICAgICBjb25zdCBwaG9uZUlucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faW5wdXQtcGhvbmUnKTtcbiAgICAgICAgY29uc3QgZGF0ZUlucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faW5wdXQtZGF0ZScpO1xuICAgICAgICBjb25zdCByZWdpb25JbnB1dCA9IGZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX2lucHV0LXJlZ2lvbicpO1xuICAgICAgICBjb25zdCBjaGVja2JveElucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faW5wdXQtY2hlY2tib3gnKTtcbiAgICAgICAgY29uc3QgcmFkaW9JbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W25hbWU9XCJ5ZXMtbm9cIl0nKTsgLy8g0JTQu9GPINC/0YDQvtCy0LXRgNC60Lgg0LLQvtC10L3QvdC+0YHQu9GD0LbQsNGJ0LXQs9C+XG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Ym1pdCcpO1xuICAgICAgICBjb25zdCBhbGxJbnB1dHMgPSBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtX19pbnB1dCcpO1xuICAgICAgICBjb25zdCB0ZWxlZ3JhbUlucHV0ID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9faW5wdXQtdGVsZWdyYW0nKTsgLy8g0J3RltC6INCyINGC0LXQu9C10LPRgNCw0LzRllxuICAgICAgICBjb25zdCBmb3JtV2FybmluZyA9IGZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX3dhcm5pbmcnKTsgIC8vINCa0L7QvdGC0LXQudC90LXRgCDQtNC70Y8g0L/RgNC10LTRg9C/0YDQtdC20LTQtdC90LjQuVxuXG4gICAgICAgIC8vIHRlbGVwaG9uZVxuICAgICAgICBwaG9uZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHBob25lSW5wdXQudmFsdWUudHJpbSgpID09PSAnJykge1xuICAgICAgICAgICAgICAgIHBob25lSW5wdXQudmFsdWUgPSAnKzM4JzsgLy8g0JDQstGC0L7Qt9Cw0L/QvtC70L3QtdC90LjQtSDQv9GA0Lgg0YTQvtC60YPRgdC1XG4gICAgICAgICAgICAgICAgcGhvbmVJbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSgzLCAzKTsgLy8g0KHRgtCw0LLQuNC8INC60YPRgNGB0L7RgCDQv9C+0YHQu9C1ICszOFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBwaG9uZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGxldCBzdGFydCA9IHRoaXMuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICAgICAgICBsZXQgcmF3VmFsdWUgPSB0aGlzLnZhbHVlLnJlcGxhY2UoL1xcRC9nLCAnJyk7IC8vINCj0LHQuNGA0LDQtdC8INCy0YHQtSDQvdC10YbQuNGE0YDQvtCy0YvQtSDRgdC40LzQstC+0LvRi1xuXG4gICAgICAgICAgICBpZiAoZS5pbnB1dFR5cGUgPT09IFwiZGVsZXRlQ29udGVudEJhY2t3YXJkXCIgJiYgdGhpcy52YWx1ZS5lbmRzV2l0aChcIiBcIikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZS5zbGljZSgwLCAtMSk7XG4gICAgICAgICAgICAgICAgc3RhcnQtLTsgLy8g0JrQvtGA0YDQtdC60YLQuNGA0YPQtdC8INC/0L7Qt9C40YbQuNGOINC60LDRgNC10YLQutC4INC/0YDQuCDRg9C00LDQu9C10L3QuNC4INC/0YDQvtCx0LXQu9CwXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBmb3JtYXR0ZWRWYWx1ZSA9ICcrMzgnO1xuXG4gICAgICAgICAgICBpZiAocmF3VmFsdWUubGVuZ3RoID4gMikgZm9ybWF0dGVkVmFsdWUgKz0gJyAnICsgcmF3VmFsdWUuc2xpY2UoMiwgNSk7XG4gICAgICAgICAgICBpZiAocmF3VmFsdWUubGVuZ3RoID4gNSkgZm9ybWF0dGVkVmFsdWUgKz0gJyAnICsgcmF3VmFsdWUuc2xpY2UoNSwgOCk7XG4gICAgICAgICAgICBpZiAocmF3VmFsdWUubGVuZ3RoID4gOCkgZm9ybWF0dGVkVmFsdWUgKz0gJyAnICsgcmF3VmFsdWUuc2xpY2UoOCwgMTApO1xuICAgICAgICAgICAgaWYgKHJhd1ZhbHVlLmxlbmd0aCA+IDEwKSBmb3JtYXR0ZWRWYWx1ZSArPSAnICcgKyByYXdWYWx1ZS5zbGljZSgxMCwgMTIpO1xuXG4gICAgICAgICAgICAvLyDQntC/0YDQtdC00LXQu9GP0LXQvCDRgNCw0LfQvdC40YbRgyDQsiDQtNC70LjQvdC1XG4gICAgICAgICAgICBsZXQgZGlmZiA9IGZvcm1hdHRlZFZhbHVlLmxlbmd0aCAtIHRoaXMudmFsdWUubGVuZ3RoO1xuXG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gZm9ybWF0dGVkVmFsdWU7XG5cbiAgICAgICAgICAgIC8vINCa0L7RgNGA0LXQutGC0LjRgNGD0LXQvCDQv9C+0LfQuNGG0LjRjiDQutCw0YDQtdGC0LrQuFxuICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb25SYW5nZShzdGFydCArIGRpZmYsIHN0YXJ0ICsgZGlmZik7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgLy9jYWxlbmRhclxuICAgICAgICBkYXRlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zdCBwYXJ0cyA9IHRoaXMudmFsdWUuc3BsaXQoJy0nKTtcbiAgICAgICAgICAgIGlmIChwYXJ0c1swXSAmJiBwYXJ0c1swXS5sZW5ndGggPiA0KSB7XG4gICAgICAgICAgICAgICAgcGFydHNbMF0gPSBwYXJ0c1swXS5zbGljZSgwLCA0KTtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gcGFydHMuam9pbignLScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvL2lucHV0XG4gICAgICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldElucHV0ID0gZXZlbnQudGFyZ2V0O1xuXG4gICAgICAgICAgICBpZiAodGFyZ2V0SW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd3YXJuaW5nJykpIHtcbiAgICAgICAgICAgICAgICB2YWxpZGF0ZVNpbmdsZUlucHV0KHRhcmdldElucHV0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaXNBbnlJbnB1dEZpbGxlZCA9IEFycmF5LmZyb20oYWxsSW5wdXRzKS5zb21lKGlucHV0ID0+IGlucHV0LnZhbHVlLnRyaW0oKSAhPT0gXCJcIiB8fCBpbnB1dC5jaGVja2VkKTtcbiAgICAgICAgICAgIGlmIChpc0FueUlucHV0RmlsbGVkKSB7XG4gICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGNoZWNrIDEgaW5wdXRcbiAgICAgICAgZnVuY3Rpb24gdmFsaWRhdGVTaW5nbGVJbnB1dChpbnB1dCkge1xuICAgICAgICAgICAgaWYgKGlucHV0LnR5cGUgPT09IFwiZGF0ZVwiICYmIGlucHV0LnZhbHVlID09PSBcIjIwMDAtMDEtMDFcIikge1xuICAgICAgICAgICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoJ3dhcm5pbmcnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXQudmFsdWUudHJpbSgpID09PSBcIlwiIHx8IChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2Zvcm1fX2lucHV0LXBob25lJykgJiYgIS9eXFwrMzhcXHMqXFxkezN9XFxzKlxcZHszfVxccypcXGR7Mn1cXHMqXFxkezJ9JC8udGVzdChpbnB1dC52YWx1ZSkpKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnd2FybmluZycpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2Zvcm1fX2lucHV0LXJlZ2lvbicpICYmIGlucHV0LnZhbHVlID09PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnd2FybmluZycpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2Zvcm1fX2lucHV0LWNoZWNrYm94JykgJiYgIWlucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCd3YXJuaW5nJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0LmNsYXNzTGlzdC5jb250YWlucygnZm9ybV9faW5wdXQtcmFkaW8nKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzUmFkaW9DaGVja2VkID0gQXJyYXkuZnJvbShyYWRpb0lucHV0cykuc29tZShyYWRpbyA9PiByYWRpby5jaGVja2VkKTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzUmFkaW9DaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhZGlvSW5wdXRzLmZvckVhY2gocmFkaW8gPT4gcmFkaW8uY2xhc3NMaXN0LmFkZCgnd2FybmluZycpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByYWRpb0lucHV0cy5mb3JFYWNoKHJhZGlvID0+IHJhZGlvLmNsYXNzTGlzdC5yZW1vdmUoJ3dhcm5pbmcnKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCd3YXJuaW5nJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyB2YWxpZGF0aW9uXG5cbiAgICAgICAgZnVuY3Rpb24gIGNoZWNrVmFsaWQoKXtcbiAgICAgICAgICAgIGxldCBpc1ZhbGlkID0gZmFsc2VcbiAgICAgICAgICAgIGNvbnN0IHdhcm5pbmdzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLndhcm5pbmdcIik7XG4gICAgICAgICAgICB3YXJuaW5ncy5mb3JFYWNoKHdhcm5pbmcgPT4gd2FybmluZy5jbGFzc0xpc3QucmVtb3ZlKFwid2FybmluZ1wiKSk7IC8vINCe0YfQuNGB0YLQuNGC0Lgg0L/QvtC/0LXRgNC10LTQvdGWINC/0L7QvNC40LvQutC4XG5cbiAgICAgICAgICAgIGNvbnN0IGFkZFdhcm5pbmcgPSAoaW5wdXQsIG1lc3NhZ2UpID0+IHtcblxuICAgICAgICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKFwid2FybmluZ1wiKTtcbiAgICAgICAgICAgICAgICBsZXQgd2FybmluZ01lc3NhZ2UgPSBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgaWYgKCF3YXJuaW5nTWVzc2FnZSB8fCAhd2FybmluZ01lc3NhZ2UuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZm9ybV9fd2FybmluZ1wiKSkge1xuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTWVzc2FnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICAgICAgICAgICAgICAgICAgICB3YXJuaW5nTWVzc2FnZS5jbGFzc0xpc3QuYWRkKFwiZm9ybV9fd2FybmluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgd2FybmluZ01lc3NhZ2UudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICBpbnB1dC5wYXJlbnROb2RlLmFwcGVuZENoaWxkKHdhcm5pbmdNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBsZXQgc3VybmFtZVZhbGlkID0gZmFsc2VcbiAgICAgICAgICAgIGxldCBmaXJzdE5hbWVWYWxpZCA9IGZhbHNlXG4gICAgICAgICAgICBsZXQgc2Vjb25kTmFtZVZhbGlkID0gZmFsc2VcbiAgICAgICAgICAgIGxldCBwaG9uZVZhbGlkID0gZmFsc2VcbiAgICAgICAgICAgIGxldCBiaXJ0aERhdGVWYWxpZCA9IGZhbHNlXG4gICAgICAgICAgICBsZXQgaXNNaWxpdGFyeVZhbGlkID0gZmFsc2VcbiAgICAgICAgICAgIGxldCBjb25zZW50VmFsaWQgPSBmYWxzZVxuXG5cbiAgICAgICAgICAgIGNvbnN0IHN1cm5hbWUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtc3VybmFtZVwiKTtcbiAgICAgICAgICAgIHN1cm5hbWUuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+e1xuICAgICAgICAgICAgICAgIGlmICghc3VybmFtZS52YWx1ZS50cmltKCkpIGFkZFdhcm5pbmcoc3VybmFtZSwgXCLQn9GA0ZbQt9Cy0LjRidC1INC+0LHQvtCyJ9GP0LfQutC+0LLQtVwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBpZiAoIXN1cm5hbWUudmFsdWUudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgYWRkV2FybmluZyhzdXJuYW1lLCBcItCf0YDRltC30LLQuNGJ0LUg0L7QsdC+0LIn0Y/Qt9C60L7QstC1XCIpO1xuXG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBzdXJuYW1lVmFsaWQgPSB0cnVlXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGZpcnN0TmFtZSA9IGZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dC1maXJzdC1uYW1lXCIpO1xuICAgICAgICAgICAgaWYgKCFmaXJzdE5hbWUudmFsdWUudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgYWRkV2FybmluZyhmaXJzdE5hbWUsIFwi0IbQvCfRjyDQvtCx0L7QsifRj9C30LrQvtCy0LVcIik7XG5cbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIGZpcnN0TmFtZVZhbGlkID0gdHJ1ZVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzZWNvbmROYW1lID0gZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0LW1pZGRsZS1uYW1lXCIpO1xuICAgICAgICAgICAgaWYgKCFzZWNvbmROYW1lLnZhbHVlLnRyaW0oKSkge1xuICAgICAgICAgICAgICAgIGFkZFdhcm5pbmcoc2Vjb25kTmFtZSwgXCLQn9C+INCx0LDRgtGM0LrQvtCy0ZYg0L7QsdC+0LIn0Y/Qt9C60L7QstC1XCIpO1xuXG5cbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHNlY29uZE5hbWVWYWxpZCA9IHRydWVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcGhvbmUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtcGhvbmVcIik7XG4gICAgICAgICAgICBpZiAoIXBob25lLnZhbHVlLnRyaW0oKSB8fCAhL15cXCszOFxccz9cXGR7M31cXHM/XFxkezN9XFxzP1xcZHsyfVxccz9cXGR7Mn0kLy50ZXN0KHBob25lLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGFkZFdhcm5pbmcocGhvbmUsIFwi0J3QvtC80LXRgCDRgtC10LvQtdGE0L7QvdGDINC+0LHQvtCyJ9GP0LfQutC+0LLQuNC5XCIpO1xuXG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBwaG9uZVZhbGlkID0gdHJ1ZVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBiaXJ0aERhdGUgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtZGF0ZVwiKTtcbiAgICAgICAgICAgIGlmICghYmlydGhEYXRlLnZhbHVlIHx8IGJpcnRoRGF0ZS52YWx1ZSA9PT0gXCIyMDAwLTAxLTAxXCIpIHtcbiAgICAgICAgICAgICAgICBhZGRXYXJuaW5nKGJpcnRoRGF0ZSwgXCLQlNCw0YLQsCDQvdCw0YDQvtC00LbQtdC90L3RjyDQvtCx0L7QsifRj9C30LrQvtCy0LBcIik7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBiaXJ0aERhdGVWYWxpZCA9IHRydWVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaXNNaWxpdGFyeSA9IGZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dC1yYWRpbzpjaGVja2VkXCIpO1xuICAgICAgICAgICAgaWYgKCFpc01pbGl0YXJ5KXtcbiAgICAgICAgICAgICAgICBhZGRXYXJuaW5nKGZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19yYWRpby1ncm91cFwiKSwgXCLQntCx0LXRgNGW0YLRjCDQstCw0YDRltCw0L3RglwiKTtcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICBpc01pbGl0YXJ5VmFsaWQgPSB0cnVlXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNvbnNlbnQgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXQtY2hlY2tib3hcIik7XG4gICAgICAgICAgICBpZiAoIWNvbnNlbnQuY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIGFkZFdhcm5pbmcoY29uc2VudCwgXCLQktC4INC/0L7QstC40L3QvdGWINC/0L7Qs9C+0LTQuNGC0LjRgdGPINC3INC+0LHRgNC+0LHQutC+0Y4g0LTQsNC90LjRhVwiKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIGNvbnNlbnRWYWxpZCA9IHRydWVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN1cm5hbWVWYWxpZCAmJiBmaXJzdE5hbWVWYWxpZCAmJiBzZWNvbmROYW1lVmFsaWQgJiYgcGhvbmVWYWxpZCAmJiBiaXJ0aERhdGVWYWxpZCAmJiBpc01pbGl0YXJ5VmFsaWQgJiYgY29uc2VudFZhbGlkKXtcbiAgICAgICAgICAgICAgICBpc1ZhbGlkID0gdHJ1ZVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgICAgICAgICAgICBmb3JtV2FybmluZy5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3dhcm5pbmcnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9ybVdhcm5pbmcuY2xhc3NMaXN0LnJlbW92ZSgndmlzaWJsZScpO1xuICAgICAgICAgICAgICAgIHN1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCd3YXJuaW5nJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBpc1ZhbGlkXG4gICAgICAgIH1cblxuXG4gICAgICAgIGZvcm1zLmZvckVhY2goZm9ybSA9PiB7XG4gICAgICAgICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8g0JfQsNCx0LvQvtC60YPQstCw0YLQuCDRgdGC0LDQvdC00LDRgNGC0L3RgyDQstGW0LTQv9GA0LDQstC60YNcblxuICAgICAgICAgICAgICAgIGxldCBpc1ZhbGlkID0gY2hlY2tWYWxpZCgpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlzVmFsaWQpO1xuXG4gICAgICAgICAgICAgICAgLy8g0J/QtdGA0LXQstGW0YDQutCwINC60LDQv9GC0YfRllxuICAgICAgICAgICAgICAgIGNvbnN0IHJlY2FwdGNoYVJlc3BvbnNlID0gZ3JlY2FwdGNoYS5nZXRSZXNwb25zZSgpOyAvLyDQntGC0YDQuNC80YPRlNC80L4g0LLRltC00L/QvtCy0ZbQtNGMINC3INC60LDQv9GC0YfRllxuICAgICAgICAgICAgICAgIGlmIChyZWNhcHRjaGFSZXNwb25zZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8g0J/QtdGA0LXQstGW0YDQutCwINC60LDQv9GC0YfRliDQu9C40YjQtSDQvtC00LjQvSDRgNCw0LdcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVjYXB0Y2hhJykuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwi0JHRg9C00Ywg0LvQsNGB0LrQsCwg0L/RgNC+0LnQtNGW0YLRjCDQv9C10YDQtdCy0ZbRgNC60YMgcmVDQVBUQ0hBLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wYWdlJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7IC8vINCh0YXQvtCy0LDRgtC4INC60L7QvdGC0LXQvdGCXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVjYXB0Y2hhJykuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsgLy8g0J/QvtC60LDQt9Cw0YLQuCDQutCw0L/RgtGH0YNcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZWNhcHRjaGEnKS5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7IC8vINCU0L7QtNCw0YLQuCDQutC70LDRgSwg0YnQvtCxINC90LUg0L/QvtCy0YLQvtGA0Y7QstCw0YLQuCDQv9C10YDQtdCy0ZbRgNC60YNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47IC8vINCv0LrRidC+INC60LDQv9GC0YfQsCDQvdC1INC/0YDQvtC50LTQtdC90LAsINC90LUg0LLRltC00L/RgNCw0LLQu9GP0ZTQvNC+INGE0L7RgNC80YNcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YShmb3JtKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdWNjZXNzTWVzc2FnZSA9IGZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3NNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtV2FybmluZy5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5yZXNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NNZXNzYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUoJ3Zpc2libGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtV2FybmluZy5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5yZXNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBmZXRjaChmb3JtLmFjdGlvbiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IGZvcm1EYXRhXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS50ZXh0KCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsgLy8g0JLQuNCy0LXRgdGC0Lgg0LLRltC00L/QvtCy0ZbQtNGMINCy0ZbQtCDRgdC10YDQstC10YDQsFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VjY2Vzc01lc3NhZ2UgPSBmb3JtLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19zdWNjZXNzJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fd2FybmluZycpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuaW5jbHVkZXMoXCLQlNGP0LrRg9GU0LzQviDQt9CwINCy0LDRiNGDINC30LDRj9Cy0LrRgyFcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g0J/QvtC60LDQt9Cw0YLQuCDQv9C+0LLRltC00L7QvNC70LXQvdC90Y8g0L/RgNC+INGD0YHQv9GW0YVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3NNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzTWVzc2FnZS5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5yZXNldCgpOyAvLyDQntGH0LjRgdGC0LjRgtC4INGE0L7RgNC80YNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g0J/QvtC60LDQt9Cw0YLQuCDQv9C+0LLRltC00L7QvNC70LXQvdC90Y8g0L/RgNC+INC/0L7QvNC40LvQutGDXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcItCf0L7QvNC40LvQutCwINC/0YDQuCDQstGW0LTQv9GA0LDQstGG0ZYg0YTQvtGA0LzQuDpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX3dhcm5pbmcnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZS50ZXh0Q29udGVudCA9IFwi0J/QvtC80LjQu9C60LAg0L/RgNC4INCy0ZbQtNC/0YDQsNCy0YbRliDRhNC+0YDQvNC4LiDQodC/0YDQvtCx0YPQudGC0LUg0YnQtSDRgNCw0LcuXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCd2aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG5cblxuICAgIH0pO1xufSk7XG5cblxuXG4iXX0=
